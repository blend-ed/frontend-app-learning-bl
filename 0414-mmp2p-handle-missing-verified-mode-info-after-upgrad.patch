From 9dcb91af9edbce2e02f2dc14a9d51998081794b3 Mon Sep 17 00:00:00 2001
From: Ben Warzeski <bwarzeski@edx.org>
Date: Tue, 30 Mar 2021 11:18:49 -0400
Subject: [PATCH 0414/1021] mmp2p: handle missing verified-mode info after
 upgrade deadline (#401)

---
 src/experiments/mm-p2p/index.jsx | 22 +++++++++++++++-------
 1 file changed, 15 insertions(+), 7 deletions(-)

diff --git a/src/experiments/mm-p2p/index.jsx b/src/experiments/mm-p2p/index.jsx
index 89d4cfa..d040dd2 100644
--- a/src/experiments/mm-p2p/index.jsx
+++ b/src/experiments/mm-p2p/index.jsx
@@ -115,13 +115,16 @@ const initHomeMMP2P = (courseId) => {
   if (
     accessExpiration !== null
     && accessExpiration !== undefined
-    && verifiedMode !== null
-    && verifiedMode !== undefined
   ) {
     access.isAudit = true;
     access.accessExpirationDate = accessExpiration.expirationDate;
     access.upgradeUrl = accessExpiration.upgradeUrl;
-    access.price = `${verifiedMode.currencySymbol}${verifiedMode.price}`;
+    if (
+      verifiedMode !== null
+      && verifiedMode !== undefined
+    ) {
+      access.price = `${verifiedMode.currencySymbol}${verifiedMode.price}`;
+    }
   }
 
   return {
@@ -186,13 +189,16 @@ const initCoursewareMMP2P = (courseId, sequenceId, unitId) => {
   if (
     accessExpiration !== null
     && accessExpiration !== undefined
-    && verifiedMode !== null
-    && verifiedMode !== undefined
   ) {
     access.isAudit = true;
     access.accessExpirationDate = accessExpiration.expirationDate;
     access.upgradeUrl = accessExpiration.upgradeUrl;
-    access.price = `${verifiedMode.currencySymbol}${verifiedMode.price}`;
+    if (
+      verifiedMode !== null
+      && verifiedMode !== undefined
+    ) {
+      access.price = `${verifiedMode.currencySymbol}${verifiedMode.price}`;
+    }
   }
 
   // testing
@@ -222,12 +228,14 @@ const initCoursewareMMP2P = (courseId, sequenceId, unitId) => {
   );
   meta.blockContent = (MMP2POptions.isEnabled && meta.verifiedLock);
 
-  return {
+  const config = {
     access,
     flyover,
     meta,
     state: MMP2POptions,
   };
+
+  return config;
 };
 
 export {
-- 
2.34.1

